<!DOCTYPE html>
<html lang="th">
<head>
  <link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#61BA93">
<link rel="apple-touch-icon" href="icon-192.png">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<title>Image to PDF</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
:root{
  --primary:#61BA93;
  --primary-dark:#4da881;
  --bg:#f4fbf8;
  --card:#ffffff;
  --text:#1e1e1e;
}

body.dark{
  --bg:#0f1a17;
  --card:#162420;
  --text:#f2f2f2;
}

*{margin:0;padding:0;box-sizing:border-box}

html,body{
  height:100%;
  font-family:'Kanit',sans-serif;
  background:var(--bg);
  color:var(--text);
  transition:.3s;
}

body{
  display:flex;
  flex-direction:column;
}

.main{
  flex:1;
  display:flex;
  justify-content:center;
  align-items:center;
  padding:20px;
}

.card{
  width:100%;
  max-width:430px;
  background:var(--card);
  padding:28px 22px;
  border-radius:28px;
  box-shadow:0 10px 30px rgba(0,0,0,.08);
  text-align:center;
  animation:fade .4s ease;
}

@keyframes fade{
  from{opacity:0;transform:translateY(15px)}
  to{opacity:1;transform:translateY(0)}
}

.logo{width:75px;margin-bottom:12px}

input[type=file],
#pdfName,
.btn{
  width:100%;
  padding:15px;
  border-radius:18px;
  font-size:.95rem;
  margin-bottom:15px;
  border:none;
}

input[type=file]{
  border:2px dashed var(--primary);
  background:transparent;
}

#pdfName{
  background:#ffffff15;
  border:1px solid #ffffff30;
  color:var(--text);
}

.btn{
  background:var(--primary);
  color:#fff;
  font-weight:600;
  cursor:pointer;
  transition:.25s;
}

.btn:hover{
  background:var(--primary-dark);
  transform:translateY(-2px)
}

#result{min-height:24px;font-weight:600}
.success{color:var(--primary)}
.error{color:#ff5a5a}

/* Progress */
.progress-container{
  width:100%;
  height:8px;
  background:#00000015;
  border-radius:10px;
  overflow:hidden;
  margin-bottom:15px;
  display:none;
}

.progress-bar{
  height:100%;
  width:0%;
  background:var(--primary);
  transition:.3s;
}

/* Download Box */
.download-box{
  margin-top:15px;
  padding:18px;
  border-radius:18px;
  background:linear-gradient(135deg,#61BA93,#4da881);
  color:#fff;
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:10px;
  animation:fade .3s ease;
}

.download-info{
  text-align:left;
  font-size:.9rem;
  overflow:hidden;
}

.download-info strong{
  display:block;
  font-size:1rem;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
}

.download-actions{
  display:flex;
  gap:8px;
}

.download-btn{
  background:#ffffff;
  color:#61BA93;
  border:none;
  padding:8px 14px;
  border-radius:12px;
  font-size:.8rem;
  font-weight:600;
  cursor:pointer;
  transition:.2s;
}

.download-btn:hover{
  transform:scale(1.05);
}

.toggle{
  position:fixed;
  top:18px;
  right:18px;
  cursor:pointer;
  font-size:20px;
}
</style>
</head>

<body>

<div class="toggle" onclick="toggleDark()">üåô</div>

<div class="main">
  <div class="card">
    <img src="https://github.com/xsararex/psd/blob/main/01.png?raw=true" class="logo">

    <div class="progress-container" id="progressBox">
      <div class="progress-bar" id="progressBar"></div>
    </div>

    <input type="file" id="images" accept="image/*" multiple>
    <button class="btn" onclick="makePDF()">Convert to PDF</button>

    <div id="result"></div>

    <div id="filenameBox" style="display:none">
      <input type="text" id="pdfName" placeholder="Name PDF">
      <button class="btn" onclick="confirmUploadPDF()">‚úî OK</button>
    </div>
  </div>
</div>

<script>
const { jsPDF } = window.jspdf;
let imageFiles=[];

images.addEventListener('change',e=>{
  imageFiles=Array.from(e.target.files);
});

function toggleDark(){
  document.body.classList.toggle("dark");
  localStorage.setItem("darkMode",document.body.classList.contains("dark"));
}
if(localStorage.getItem("darkMode")==="true"){
  document.body.classList.add("dark");
}

async function makePDF(){
  if(imageFiles.length===0){
    result.innerHTML="<span class='error'>‚ö† ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏π‡∏õ‡∏Å‡πà‡∏≠‡∏ô</span>";
    return;
  }

  progressBox.style.display="block";
  progressBar.style.width="0%";
  result.innerHTML="‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á PDF...";

  const pdf=new jsPDF();

  for(let i=0;i<imageFiles.length;i++){
    const imgData=await toBase64(imageFiles[i]);
    const img=new Image();
    img.src=imgData;
    await new Promise(res=>img.onload=res);

    let w=pdf.internal.pageSize.getWidth();
    let h=(img.height*w)/img.width;
    let maxH=pdf.internal.pageSize.getHeight();
    if(h>maxH) h=maxH;

    if(i>0) pdf.addPage();
    pdf.addImage(img,"JPEG",0,0,w,h);

    let percent=Math.round(((i+1)/imageFiles.length)*100);
    progressBar.style.width=percent+"%";
  }

  window.generatedPDF=pdf.output("blob");
  result.innerHTML="<span class='success'>‚úî ‡∏™‡∏£‡πâ‡∏≤‡∏á PDF ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à</span>";
  filenameBox.style.display="block";
}

async function confirmUploadPDF(){
  const name=pdfName.value.trim();
  if(!name){alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå");return;}

  result.innerHTML=`
  <div class="download-box">
    <div class="download-info">
      <span>‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à</span>
      <strong>${name}.pdf</strong>
    </div>
    <div class="download-actions">
      <button class="download-btn" onclick="downloadFile('${name}')">‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î</button>
      <button class="download-btn" onclick="shareToLine('${name}')">‡πÅ‡∏ä‡∏£‡πå LINE</button>
    </div>
  </div>
  `;
}

function downloadFile(name){
  const file=new File([window.generatedPDF],name+".pdf",{type:"application/pdf"});
  const url=URL.createObjectURL(file);
  const a=document.createElement("a");
  a.href=url;
  a.download=name+".pdf";
  a.click();
}

async function shareToLine(name){
  const file=new File([window.generatedPDF],name+".pdf",{type:"application/pdf"});

  if(navigator.canShare && navigator.canShare({ files:[file] })){
    try{
      await navigator.share({
        title:name,
        text:"‡∏™‡πà‡∏á‡πÑ‡∏ü‡∏•‡πå PDF",
        files:[file]
      });
    }catch(err){}
  }else{
    alert("‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏ä‡∏£‡πå‡πÑ‡∏ü‡∏•‡πå\n‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡∏¥‡∏î‡∏à‡∏≤‡∏Å‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠‡∏ú‡πà‡∏≤‡∏ô https");
  }
}

function toBase64(file){
  return new Promise((res,rej)=>{
    const reader=new FileReader();
    reader.readAsDataURL(file);
    reader.onload=()=>res(reader.result);
    reader.onerror=e=>rej(e);
  });
}
</script>

</body>
</html>

